# Example Setup

### Prerequisites 

* [Mirrord](https://mirrord.dev/)
* Available Kubernetes Cluster (perferably local for this example)
* [NodeJS](https://nodejs.org/en/) + [Yarn](https://www.npmjs.com/package/yarn)
* (optinal) [golang-migrate](https://github.com/golang-migrate/migrate)


### Clone Repo
First clone the example repo

```bash
git clone https://github.com/metalbear-co/nodejs-example.git
cd nodejs-example
```

### Setup Cluster
To show the example you will need to create a few deployments and services

```bash
kubectl apply -f app.yaml
```

This command will create 3 deployments and relevant services
* example-pg - Postgres Database
* example-idp - [Dexidp](https://dexidp.io/) OIDC provider
* example-blog - NodeJS application located in ./blog

After first initialisation the example-idp and example-blog deployments may not work out of the box for to fix this we need to run migrations

### Migrations

If you have golang-migrate installed simply run

```bash
./run_migration.sh
```

Or if you don't have golang-migrate installed then you'll simply need to execute the sql files located in `./migrations` to create the databases, after reconnecting to `blog` database from the previous action created run all sqls located in `./migrations/blog`

#### [Next Step](./03.%20Mirrord%20mirroring.md)